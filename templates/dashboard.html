{% extends "base.html" %}
{% block content %}

<h2>Dashboard</h2>

<div style="display:flex; gap:20px; margin-bottom:30px;">
    <div class="card">Total Students<br><b>{{ total_students }}</b></div>
    <div class="card">Active Students<br><b>{{ active_students }}</b></div>
    <div class="card">Total Courses<br><b>{{ total_courses }}</b></div>
    <div class="card">Attendance Rate<br><b>{{ attendance_rate }}%</b></div>
</div>

<div style="display:flex; gap:40px; justify-content:center;">
    <div style="width:40%;">    
        <canvas id="courseChart"></canvas>
    </div>
  
    <div style="width:50%;">
        <canvas id="monthlyChart"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script type="text/javascript">
/* ---------- PIE CHART ---------- */
const courseLabelsData = JSON.parse('{{ course_labels | tojson | safe }}');
const courseCountsData = JSON.parse('{{ course_counts | tojson | safe }}');

new Chart(document.getElementById("courseChart"), {
    type: "pie",
    data: {
        labels: courseLabelsData,
        datasets: [{
            data: courseCountsData
        }]
    }
});

/* ---------- LINE CHART ---------- */
const monthlyLabelsData = JSON.parse('{{ months | tojson | safe }}');
const monthlyValuesData = JSON.parse('{{ monthly_counts | tojson | safe }}');

new Chart(document.getElementById("monthlyChart"), {
    type: "line",
    data: {
        labels: monthlyLabelsData,
        datasets: [{
            label: "Monthly Attendance %",
            data: monthlyValuesData,
            tension: 0.3,
            fill: false
        }]
    }
});
</script>

{% endblock %}